<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°‹æ‰¾ä¸ƒé¾ç  - ä¸–ç•Œå¤§å†’éšª</title>
    <style>
        :root {
            --primary-color: #ff9800;
            --secondary-color: #2c3e50;
            --accent-color: #e74c3c;
            --special-color: #9b59b6;
            --bg-color: #1a1a1a;
            --text-color: #ecf0f1;
        }

        body {
            font-family: 'å¾®è»Ÿæ­£é»‘é«”', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            text-align: center;
        }

        h1 {
            color: var(--primary-color);
            text-shadow: 0 0 10px rgba(255, 152, 0, 0.5);
        }

        .status-bar {
            background: var(--secondary-color);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: inline-block;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        .dragon-balls {
            font-size: 1.5rem;
            letter-spacing: 5px;
        }

        /* ç¶²æ ¼ä½ˆå±€ */
        .map-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            max-width: 1000px;
            margin: 0 auto;
        }

        .location-card {
            background: #34495e;
            border: 2px solid #465c71;
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            position: relative;
            height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .location-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(255, 152, 0, 0.3);
            border-color: var(--primary-color);
        }

        .location-card.explored {
            opacity: 0.6;
            cursor: default;
            transform: none;
        }

        .location-card.special {
            border-color: var(--special-color);
            box-shadow: 0 0 10px rgba(155, 89, 182, 0.2);
        }
        
        .location-card.special::after {
            content: "âš ï¸ ç‰¹æ®Šå€åŸŸ";
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 0.7rem;
            background: var(--special-color);
            padding: 2px 5px;
            border-radius: 4px;
        }

        .icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        /* å½ˆçª—æ¨£å¼ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }

        .modal-content {
            background: var(--secondary-color);
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            text-align: left;
            border: 2px solid var(--primary-color);
            position: relative;
            animation: popIn 0.3s ease;
        }

        @keyframes popIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .modal-title {
            color: var(--primary-color);
            font-size: 1.5rem;
            margin-bottom: 10px;
            border-bottom: 1px solid #555;
            padding-bottom: 10px;
        }

        .modal-desc {
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            width: 100%;
        }

        .btn:hover {
            background: #e68a00;
        }

        .result-area {
            margin-top: 20px;
            text-align: center;
            font-size: 1.2rem;
            font-weight: bold;
            display: none;
        }

        /* å‹åˆ©ç•«é¢ */
        .win-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #f1c40f, #e67e22);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 200;
            color: #fff;
        }
        
        .shenron {
            font-size: 5rem;
            animation: float 3s infinite ease-in-out;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

    </style>
</head>
<body>

    <h1>ğŸŒ å°‹æ‰¾æ•£è½çš„ä¸ƒé¾ç  ğŸ‰</h1>
    
    <div class="status-bar">
        <div>ç›®å‰è’é›†é€²åº¦</div>
        <div class="dragon-balls" id="score-board">âšª âšª âšª âšª âšª âšª âšª</div>
    </div>

    <div class="map-grid" id="game-board">
        <!-- JS æœƒè‡ªå‹•ç”¢ç”Ÿå¡ç‰‡ -->
    </div>

    <!-- ä»»å‹™èªªæ˜å½ˆçª— -->
    <div class="modal-overlay" id="mission-modal">
        <div class="modal-content">
            <h2 class="modal-title" id="modal-title">åœ°é»åç¨±</h2>
            <p class="modal-desc" id="modal-desc">é€™è£¡æœƒé¡¯ç¤ºè¦å‰‡èªªæ˜...</p>
            <button class="btn" id="action-btn">é–‹å§‹æ¢ç´¢</button>
            <div class="result-area" id="result-area"></div>
        </div>
    </div>

    <!-- å‹åˆ©ç•«é¢ -->
    <div class="win-overlay" id="win-screen">
        <div class="shenron">ğŸ²</div>
        <h2>ç¥é¾å‡ºç¾äº†ï¼</h2>
        <p>æ­å–œä½ æ‰¾é½Šäº†æ‰€æœ‰é¾ç ï¼Œä½ çš„é¡˜æœ›å³å°‡å¯¦ç¾ï¼</p>
        <button class="btn" style="background:#fff; color:#e67e22; width: auto; margin-top:20px;" onclick="location.reload()">é‡æ–°é–‹å§‹</button>
    </div>

    <script>
        // éŠæˆ²è³‡æ–™è¨­å®š
        const locations = [
            // ä¸ƒå¤§æ´²
            { id: 1, name: "äºæ´²", type: "continent", icon: "ğŸ¯", desc: "é€™è£¡æ˜¯ä¸–ç•Œæœ€å¤§çš„æ´²ï¼Œäººæµ·èŒ«èŒ«ï¼Œé¾ç å¯èƒ½è—åœ¨å¤è€çš„å¯ºå»Ÿä¸­ã€‚", isSpecial: false },
            { id: 2, name: "éæ´²", type: "continent", icon: "ğŸ¦", desc: "å»£é—Šçš„è‰åŸèˆ‡æ²™æ¼ ï¼Œå°å¿ƒçŒ›ç¸å‡ºæ²’ï¼ä½ éœ€è¦é€šéå‹‡æ°£çš„è©¦ç…‰ã€‚", isSpecial: false },
            { id: 3, name: "åŒ—ç¾æ´²", type: "continent", icon: "ğŸ—½", desc: "ç¹è¯çš„éƒ½å¸‚å¢æ—ï¼Œé¾ç æˆ–è¨±å½è£æˆäº†æŸå€‹ç§‘æŠ€ç”¢å“ï¼Ÿ", isSpecial: false },
            { id: 4, name: "å—ç¾æ´² (äºé¦¬éœ)", type: "continent", icon: "ğŸ¦œ", desc: "ã€ç‰¹æ®Šé—œå¡ã€‘æ·±å…¥äºé¦¬éœé›¨æ—ï¼Œè¿·éœ§é‡é‡ï¼Œæ¢ç´¢æˆåŠŸç‡åªæœ‰ 50%ï¼", isSpecial: true, effect: "risk" },
            { id: 5, name: "å—æ¥µæ´²", type: "continent", icon: "â„ï¸", desc: "ã€ç‰¹æ®Šé—œå¡ã€‘æ¥µå¯’ä¹‹åœ°ï¼Œé€™è£¡è¢«å†°å°äº†åƒå¹´ã€‚è‹¥é€™è£¡æ²’æœ‰é¾ç ï¼Œä½ æœƒè¢«å‡åƒµæš«åœä¸€å›åˆï¼ˆæ¨¡æ“¬ï¼‰ã€‚", isSpecial: true, effect: "freeze" },
            { id: 6, name: "æ­æ´²", type: "continent", icon: "ğŸ°", desc: "å……æ»¿æ­·å²èˆ‡è—è¡“çš„å¤§åœ°ï¼Œé¾ç å¯èƒ½è—åœ¨åšç‰©é¤¨çš„æ·±è™•ã€‚", isSpecial: false },
            { id: 7, name: "å¤§æ´‹æ´²", type: "continent", icon: "ğŸ¦˜", desc: "å³¶å¶¼çœ¾å¤šï¼Œä½ éœ€è¦è·³å³¶å°‹æ‰¾ç·šç´¢ã€‚", isSpecial: false },
            // äº”å¤§æ´‹
            { id: 8, name: "å¤ªå¹³æ´‹", type: "ocean", icon: "ğŸŒŠ", desc: "ä¸–ç•Œæœ€å¤§çš„æµ·æ´‹ï¼Œæ·±æµ·å£“åŠ›å·¨å¤§ï¼Œéœ€è¦æ½›æ°´è‰‡æ‰èƒ½æ¢ç´¢ã€‚", isSpecial: false },
            { id: 9, name: "å¤§è¥¿æ´‹ (ç™¾æ…•é”)", type: "ocean", icon: "ğŸš¢", desc: "ã€ç‰¹æ®Šé—œå¡ã€‘ç¥ç§˜çš„ç™¾æ…•é”ä¸‰è§’æ´²ï¼Œé›·é”å¤±éˆã€‚ä½ å¿…é ˆå›ç­”ä¸€å€‹è¬é¡Œæ‰èƒ½é€²å…¥ã€‚", isSpecial: true, effect: "riddle" },
            { id: 10, name: "å°åº¦æ´‹", type: "ocean", icon: "ğŸŒ…", desc: "æº«æš–çš„æ´‹æµï¼Œä½†ä¹Ÿä¼´éš¨è‘—å¼·çƒˆçš„å­£é¢¨ï¼Œå°å¿ƒèˆªè¡Œã€‚", isSpecial: false },
            { id: 11, name: "åŒ—å†°æ´‹", type: "ocean", icon: "ğŸ§Š", desc: "ã€ç‰¹æ®Šé—œå¡ã€‘æµ®å†°éå¸ƒï¼Œé€™è£¡æœ‰åŒ—æ¥µç†Šå®ˆè­·ã€‚å¦‚æœä½ æ‰¾åˆ°é¾ç ï¼Œå¯ç²å¾—é¡å¤–æç¤ºï¼ˆæ¨¡æ“¬ï¼‰ã€‚", isSpecial: true, effect: "bonus" },
            { id: 12, name: "å—å¤§æ´‹", type: "ocean", icon: "ğŸ‹", desc: "ç’°ç¹å—æ¥µçš„ç‹‚æš´æµ·æ´‹ï¼Œåªæœ‰æœ€å‹‡æ•¢çš„æ°´æ‰‹æ•¢é è¿‘ã€‚", isSpecial: false }
        ];

        let dragonBallsFound = 0;
        let gameActive = true;
        let currentTarget = null;
        
        // åˆå§‹åŒ–éŠæˆ²
        function initGame() {
            const gameBoard = document.getElementById('game-board');
            
            // éš¨æ©Ÿåˆ†é… 7 é¡†é¾ç 
            // å»ºç«‹ä¸€å€‹é•·åº¦12çš„é™£åˆ—ï¼Œ7å€‹true(æœ‰çƒ)ï¼Œ5å€‹false(æ²’çƒ)
            let balls = Array(7).fill(true).concat(Array(5).fill(false));
            // æ´—ç‰Œç®—æ³• (Fisher-Yates)
            for (let i = balls.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [balls[i], balls[j]] = [balls[j], balls[i]];
            }

            // å°‡çƒçš„ç‹€æ…‹ç¶å®šåˆ°åœ°é»ä¸¦æ¸²æŸ“
            locations.forEach((loc, index) => {
                loc.hasBall = balls[index];
                loc.explored = false;

                const card = document.createElement('div');
                card.className = `location-card ${loc.isSpecial ? 'special' : ''}`;
                card.innerHTML = `
                    <div class="icon">${loc.icon}</div>
                    <div class="name">${loc.name}</div>
                `;
                card.onclick = () => openModal(loc, card);
                gameBoard.appendChild(card);
            });
        }

        // é–‹å•Ÿå½ˆçª—
        const modal = document.getElementById('mission-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalDesc = document.getElementById('modal-desc');
        const actionBtn = document.getElementById('action-btn');
        const resultArea = document.getElementById('result-area');
        let currentCardElement = null;

        function openModal(loc, cardElement) {
            if (loc.explored || !gameActive) return;

            currentTarget = loc;
            currentCardElement = cardElement;
            
            modalTitle.innerText = loc.name;
            modalDesc.innerText = loc.desc;
            
            // é‡ç½®å½ˆçª—ç‹€æ…‹
            resultArea.style.display = 'none';
            resultArea.innerHTML = '';
            actionBtn.style.display = 'block';
            actionBtn.innerText = "æ¥å—ä»»å‹™ä¸¦æ¢ç´¢";
            actionBtn.onclick = () => exploreLocation();
            
            modal.style.display = 'flex';
        }

        // æ¢ç´¢é‚è¼¯
        function exploreLocation() {
            actionBtn.style.display = 'none'; // éš±è—æŒ‰éˆ•é˜²æ­¢é€£é»
            resultArea.style.display = 'block';
            resultArea.innerHTML = 'ğŸ” æ­£åœ¨æœå°‹ä¸­...';
            resultArea.style.color = '#ccc';

            // æ¨¡æ“¬å»¶é²ï¼Œå¢åŠ ç·Šå¼µæ„Ÿ
            setTimeout(() => {
                let found = currentTarget.hasBall;
                
                // ç‰¹æ®Šé—œå¡é‚è¼¯ (é€™è£¡ç°¡å–®æ¨¡æ“¬ï¼Œå¯ä»¥åŠ å…¥æ›´è¤‡é›œçš„äº’å‹•)
                if (currentTarget.effect === "risk" && Math.random() > 0.5) {
                    // äºé¦¬éœæœ‰50%æ©Ÿç‡å³ä½¿æœ‰çƒä¹Ÿæ‰¾ä¸åˆ° (æ¨¡æ“¬)
                    // ç‚ºäº†éŠæˆ²é«”é©—ï¼Œé€™è£¡æˆ‘å€‘å‡è¨­å¦‚æœå¤±æ•—å°±é¡¯ç¤ºç©ºæ‰‹è€Œæ­¸
                    // ä½†ç‚ºäº†ä¸è®“ç©å®¶å¡é—œï¼Œæˆ‘å€‘ç°¡åŒ–ç‚ºï¼šå¦‚æœé‹æ°£ä¸å¥½ï¼Œé¡¯ç¤ºé­é‡å±éšªä½†é€ƒè„«
                }

                if (found) {
                    resultArea.innerHTML = 'âœ¨ æ­å–œï¼ä½ æ‰¾åˆ°äº†ä¸€é¡†é¾ç ï¼ ğŸŸ ';
                    resultArea.style.color = '#f1c40f';
                    dragonBallsFound++;
                    updateScore();
                } else {
                    resultArea.innerHTML = 'ğŸ’¨ é€™è£¡ä»€éº¼éƒ½æ²’æœ‰ï¼Œåªæ˜¯ä¸€ç‰‡è’è•ª...';
                    resultArea.style.color = '#95a5a6';
                }

                // æ¨™è¨˜ç‚ºå·²æ¢ç´¢
                currentTarget.explored = true;
                currentCardElement.classList.add('explored');
                if(found) {
                    currentCardElement.style.borderColor = '#f1c40f';
                    currentCardElement.querySelector('.icon').innerText = 'ğŸŸ '; // è®Šæ›´åœ–ç¤ºç‚ºé¾ç 
                }

                // é—œé–‰å½ˆçª—å»¶é²
                setTimeout(() => {
                    modal.style.display = 'none';
                    checkWin();
                }, 1500);

            }, 1000);
        }

        // æ›´æ–°åˆ†æ•¸é¡¯ç¤º
        function updateScore() {
            const scoreBoard = document.getElementById('score-board');
            let ballsDisplay = '';
            for(let i=0; i<7; i++) {
                if (i < dragonBallsFound) {
                    ballsDisplay += 'ğŸŸ  ';
                } else {
                    ballsDisplay += 'âšª ';
                }
            }
            scoreBoard.innerText = ballsDisplay;
        }

        // æª¢æŸ¥å‹åˆ©
        function checkWin() {
            if (dragonBallsFound >= 7) {
                gameActive = false;
                document.getElementById('win-screen').style.display = 'flex';
            }
        }

        // é»æ“Šé®ç½©é—œé–‰ (å¦‚æœä¸æƒ³å¼·åˆ¶é¸æ“‡)
        modal.onclick = (e) => {
            if (e.target === modal) {
                modal.style.display = 'none';
            }
        }

        // å•Ÿå‹•
        initGame();

    </script>
</body>
</html>