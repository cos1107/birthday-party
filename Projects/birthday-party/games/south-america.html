<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å—ç¾æ´²æ¯”æ‰‹ç•«è…³ - ä¸ƒé¡†é¾ç Â·ä¸–ç•Œå†’éšª</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Microsoft JhengHei', 'PingFang TC', sans-serif;
      background: linear-gradient(135deg, #228B22 0%, #32CD32 50%, #90EE90 100%);
      color: #fff;
      min-height: 100vh;
      padding: 20px;
      position: relative;
      overflow-x: hidden;
    }

    /* è£é£¾æ€§èƒŒæ™¯å…ƒç´  */
    body::before {
      content: '';
      position: fixed;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background:
        radial-gradient(circle at 20% 50%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(0, 100, 0, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 40% 20%, rgba(144, 238, 144, 0.1) 0%, transparent 50%);
      animation: float 20s ease-in-out infinite;
      pointer-events: none;
    }

    @keyframes float {
      0%, 100% { transform: translate(0, 0) rotate(0deg); }
      33% { transform: translate(30px, -30px) rotate(5deg); }
      66% { transform: translate(-20px, 20px) rotate(-5deg); }
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      position: relative;
      z-index: 1;
    }

    .header {
      text-align: center;
      margin-bottom: 25px;
      animation: fadeInDown 0.6s ease;
    }

    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateY(-30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .header h1 {
      font-size: 3rem;
      margin-bottom: 15px;
      text-shadow: 0 0 30px rgba(255, 215, 0, 0.8),
                   0 5px 10px rgba(0, 0, 0, 0.5);
      background: linear-gradient(45deg, #FFD700, #FFA500, #FFD700);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: shimmer 3s ease-in-out infinite;
    }

    @keyframes shimmer {
      0%, 100% { filter: brightness(1); }
      50% { filter: brightness(1.3); }
    }

    .header p {
      font-size: 1.3rem;
      color: #ffd700;
      text-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
    }

    /* è¦å‰‡èªªæ˜å€ - æ·±è‰²èƒŒæ™¯æé«˜å¯è®€æ€§ */
    .rules-section {
      background: linear-gradient(145deg, rgba(20, 60, 30, 0.95), rgba(15, 45, 20, 0.98));
      backdrop-filter: blur(10px);
      border: 3px solid rgba(255, 215, 0, 0.7);
      border-radius: 25px;
      padding: 40px;
      margin-bottom: 30px;
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.5);
      animation: fadeInUp 0.6s ease 0.2s backwards;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .rule-header {
      text-align: center;
      margin-bottom: 30px;
    }

    .rule-header h2 {
      font-size: 2rem;
      color: #ffd700;
      margin-bottom: 10px;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
    }

    .rule-content {
      font-size: 1.1rem;
      line-height: 2;
      margin-bottom: 20px;
      color: #f0f0f0;
    }

    .rule-content h3 {
      color: #ffd700;
      font-size: 1.4rem;
      margin: 25px 0 15px 0;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
    }

    .rule-content ul {
      list-style: none;
      padding-left: 10px;
    }

    .rule-content li {
      margin-bottom: 12px;
      padding-left: 25px;
      position: relative;
      color: #fff;
    }

    .rule-content li::before {
      content: 'â€¢';
      position: absolute;
      left: 0;
      color: #90EE90;
      font-size: 1.5rem;
    }

    .rule-highlight {
      background: rgba(255, 215, 0, 0.15);
      border-left: 5px solid #ffd700;
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
      font-weight: bold;
      text-align: center;
      color: #fff;
    }

    .rule-warning {
      background: rgba(180, 50, 50, 0.3);
      border-left: 5px solid #ff6b6b;
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
    }

    .rule-warning h4 {
      color: #ff9999;
      margin-bottom: 10px;
      font-size: 1.2rem;
    }

    .rule-warning ul {
      color: #fff;
    }

    .rule-warning li {
      color: #fff;
    }

    .rule-success {
      background: rgba(76, 175, 80, 0.25);
      border-left: 5px solid #4CAF50;
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
      text-align: center;
    }

    .rule-success h4 {
      color: #90EE90;
      margin-bottom: 10px;
    }

    .start-game-btn {
      display: block;
      width: 100%;
      max-width: 300px;
      margin: 30px auto 0;
      padding: 20px 40px;
      font-size: 1.5rem;
      font-weight: bold;
      color: #fff;
      background: linear-gradient(45deg, #4CAF50, #45a049);
      border: none;
      border-radius: 50px;
      cursor: pointer;
      box-shadow: 0 8px 20px rgba(76, 175, 80, 0.4);
      transition: all 0.3s ease;
      animation: pulse-btn 2s ease-in-out infinite;
    }

    @keyframes pulse-btn {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .start-game-btn:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 12px 30px rgba(76, 175, 80, 0.6);
    }

    /* éŠæˆ²å€åŸŸ */
    .game-area {
      animation: fadeIn 0.6s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* é ‚éƒ¨è³‡è¨Šæ¬„ */
    .game-info {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 20px;
      gap: 15px;
    }

    .progress-bar {
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255, 215, 0, 0.5);
      border-radius: 15px;
      padding: 12px 30px;
      font-size: 1.3rem;
      font-weight: bold;
      text-align: center;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      color: #ffd700;
    }

    /* é¡Œç›®å€åŸŸ */
    .question-section {
      background: rgba(255, 255, 255, 0.95);
      border: 4px solid rgba(255, 215, 0, 0.8);
      border-radius: 25px;
      padding: 30px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
      margin-bottom: 30px;
      text-align: center;
    }

    .question-title {
      color: #228B22;
      font-size: 1.2rem;
      margin-bottom: 15px;
      font-weight: bold;
    }

    .animal-name {
      color: #2e7d32;
      font-size: 3.5rem;
      font-weight: bold;
      margin-bottom: 10px;
      text-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    }

    .animal-english {
      color: #4CAF50;
      font-size: 1.5rem;
      margin-bottom: 15px;
    }

    .animal-pronunciation {
      color: #757575;
      font-size: 1.1rem;
      margin-bottom: 20px;
    }

    /* åœ–ç‰‡å’Œå°çŸ¥è­˜ inline æ¨£å¼ */
    .animal-info-inline {
      display: flex;
      gap: 20px;
      margin-top: 20px;
      padding-top: 20px;
      border-top: 2px dashed #ddd;
      align-items: flex-start;
    }

    .animal-image-inline {
      flex: 0 0 200px;
      height: 150px;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    .animal-image-inline img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .animal-facts-inline {
      flex: 1;
      text-align: left;
      color: #333;
    }

    .animal-facts-inline h4 {
      color: #228B22;
      font-size: 1.2rem;
      margin-bottom: 10px;
    }

    .animal-facts-inline ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .animal-facts-inline li {
      font-size: 1rem;
      line-height: 1.6;
      padding: 5px 0;
      padding-left: 25px;
      position: relative;
      color: #555;
    }

    .animal-facts-inline li::before {
      content: 'ğŸŒ¿';
      position: absolute;
      left: 0;
      font-size: 0.9rem;
    }

    /* å‹•ä½œæŒ‰éˆ•å€ */
    .action-buttons {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-top: 20px;
      flex-wrap: wrap;
    }

    .btn {
      padding: 18px 40px;
      font-size: 1.2rem;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s ease;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      min-width: 150px;
    }

    .btn-next {
      background: linear-gradient(45deg, #2196F3, #1976D2);
      color: white;
    }

    .btn-next:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(33, 150, 243, 0.5);
    }

    .btn-correct {
      background: linear-gradient(45deg, #4CAF50, #45a049);
      color: white;
    }

    .btn-correct:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(76, 175, 80, 0.5);
    }

    .btn-complete {
      background: linear-gradient(45deg, #FF9800, #F57C00);
      color: white;
    }

    .btn-complete:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(255, 152, 0, 0.5);
    }

    .btn-back {
      background: linear-gradient(45deg, #757575, #616161);
      color: white;
    }

    .btn-back:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(117, 117, 117, 0.5);
    }

    .btn-restart {
      background: linear-gradient(45deg, #E91E63, #C2185B);
      color: white;
    }

    .btn-restart:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(233, 30, 99, 0.5);
    }

    .btn-foul {
      background: linear-gradient(45deg, #ff5722, #e64a19);
      color: white;
    }

    .btn-foul:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(255, 87, 34, 0.5);
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    /* æˆåŠŸ/æ­ç¤º Overlay */
    .success-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      z-index: 10000;
      justify-content: center;
      align-items: center;
      animation: fadeIn 0.3s ease;
    }

    .success-overlay.show {
      display: flex;
    }

    .success-content {
      text-align: center;
      animation: bounceIn 0.6s ease;
    }

    @keyframes bounceIn {
      0% { transform: scale(0.3); opacity: 0; }
      50% { transform: scale(1.05); }
      70% { transform: scale(0.9); }
      100% { transform: scale(1); opacity: 1; }
    }

    .success-content h2 {
      font-size: 2.5rem;
      color: #ffd700;
      margin-bottom: 20px;
    }

    .success-content p {
      font-size: 1.3rem;
      margin-bottom: 30px;
    }

    /* é¾ç æ­ç¤ºå‹•ç•« */
    @keyframes dragonBallReveal {
      0% {
        transform: scale(0.3) rotateY(180deg);
        opacity: 0;
      }
      50% {
        transform: scale(1.1) rotateY(90deg);
        opacity: 0.7;
      }
      100% {
        transform: scale(1) rotateY(0deg);
        opacity: 1;
      }
    }

    @keyframes iconGlow {
      0%, 100% {
        filter: drop-shadow(0 0 20px #ffd700);
      }
      50% {
        filter: drop-shadow(0 0 40px #ffd700);
      }
    }

    @keyframes fadeInUp2 {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
    @media (max-width: 768px) {
      .header h1 {
        font-size: 2rem;
      }

      .rules-section {
        padding: 25px 20px;
      }

      .rule-header h2 {
        font-size: 1.5rem;
      }

      .rule-content {
        font-size: 1rem;
      }

      .animal-name {
        font-size: 2.5rem;
      }

      .animal-english {
        font-size: 1.3rem;
      }

      .question-section {
        padding: 20px 15px;
      }

      .animal-info-inline {
        flex-direction: column;
        align-items: center;
      }

      .animal-image-inline {
        flex: none;
        width: 100%;
        max-width: 250px;
        height: 180px;
      }

      .animal-facts-inline {
        text-align: center;
      }

      .animal-facts-inline li {
        text-align: left;
      }

      .action-buttons {
        flex-direction: column;
      }

      .btn {
        width: 100%;
      }
    }

    @media (max-width: 480px) {
      body {
        padding: 10px;
      }

      .animal-name {
        font-size: 2.5rem;
      }

      .animal-english {
        font-size: 1.2rem;
      }

      .animal-image {
        height: 180px;
      }

      .animal-facts li {
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>

  <div class="container">
    <!-- æ¨™é¡Œå€ -->
    <div class="header">
      <h1>ğŸŒ å—ç¾æ´²æ¯”æ‰‹ç•«è…³</h1>
      <p>èªè­˜å—ç¾æ´²çš„ç¥å¥‡å‹•ç‰©ï¼</p>
    </div>

    <!-- è¦å‰‡èªªæ˜å€ -->
    <div id="rules-section" class="rules-section">
      <div class="rule-header">
        <h2>ğŸ­ å—ç¾æ´²å‹•ç‰©æ¯”æ‰‹ç•«è…³ ğŸ¦™</h2>
      </div>

      <div class="rule-content">
        <h3>â–¶ï¸ éŠæˆ²é€²è¡Œæ–¹å¼</h3>
        <ul>
          <li>è«‹<strong>å¹¼å¹¼çµ„ 3 ä½å°æœ‹å‹èƒŒå°è¢å¹•</strong>ï¼Œè² è²¬çŒœé¡Œ</li>
          <li>è¢å¹•ä¸Šæœƒå‡ºç¾ã€Œå—ç¾æ´²å‹•ç‰©é¡Œç›®ã€</li>
          <li>ç”±å…¶ä»– <strong>8 ä½å°æœ‹å‹ä¾åºè¼ªæµ</strong>ç”¨<strong>å‹•ä½œæˆ–èªè¨€æç¤º</strong>ï¼Œä¾†å¹«åŠ©å¹¼å¹¼çµ„å°æœ‹å‹çŒœç­”æ¡ˆ</li>
          <li>çŒœå°å¾Œï¼Œæ›ä¸‹ä¸€ä½å‡ºä¾†æ¯”æ‰‹ç•«è…³çŒœæ–°ä¸€é“é¡Œ</li>
        </ul>
      </div>

      <div class="rule-warning">
        <h4>âš ï¸ é‡è¦è¦å‰‡ï¼ˆä¸€å®šè¦éµå®ˆï¼ï¼‰</h4>
        <ul>
          <li>âœ… <strong>åªæœ‰è¼ªåˆ°çš„äººå¯ä»¥èªªè©±æç¤º</strong></li>
          <li>âŒ <strong>ä¸å¯ä»¥èªªå‡ºé¡Œç›®ä¸­å‡ºç¾çš„ä»»ä½•å­—</strong>ï¼Œèªªåˆ°ä»»ä½•ä¸€å­—è¦–åŒçŠ¯è¦</li>
          <li>âŒ <strong>é™¤äº†è¼ªåˆ°çš„äººï¼Œå…¶ä»–äººåš´ç¦ç™¼å‡ºè²éŸ³</strong>ï¼Œåªèƒ½åšå‹•ä½œï¼Œå‡ºè²äº¦è¦–åŒçŠ¯è¦</li>
          <li>çŠ¯è¦æ™‚è©²é¡Œå¤±æ•—ï¼Œæ›ä¸‹ä¸€é¡Œé‡æ–°é–‹å§‹</li>
        </ul>
      </div>

      <div class="rule-success">
        <h4>ğŸ† éé—œæ¢ä»¶</h4>
        <p style="font-size: 1.2rem; margin-top: 10px;">
          å¿…é ˆ<strong>ç­”å° 8 é¡Œ</strong>æ‰èƒ½æˆåŠŸé€šéå—ç¾æ´²é—œå¡ï¼<br>
          <span style="font-size: 1rem; color: #90EE90;">ï¼ˆçŠ¯è¦çš„é¡Œç›®ä¸ç®—ç­”å°ï¼Œæœƒç¹¼çºŒå‡ºä¸‹ä¸€é¡Œï¼‰</span><br>
        </p>
      </div>

      <button class="start-game-btn" onclick="startGameFromRules()">ğŸš€ é–‹å§‹æŒ‘æˆ°</button>
    </div>

    <!-- éŠæˆ²å€åŸŸ -->
    <div class="game-area" id="game-area" style="display: none;">
      <!-- é ‚éƒ¨è³‡è¨Šæ¬„ -->
      <div class="game-info">
        <div class="progress-bar">
          é¡Œç›®é€²åº¦ï¼š<span id="current-question">1</span> / <span id="total-questions">16</span>
        </div>
        <div class="progress-bar" style="background: rgba(76, 175, 80, 0.3); border-color: rgba(76, 175, 80, 0.8);">
          âœ… ç­”å°ï¼š<span id="correct-count">0</span> / 8ï¼ˆç­”å° 8 é¡Œå³éé—œï¼ï¼‰
        </div>
      </div>

      <!-- é¡Œç›®å€åŸŸï¼ˆåŒ…å«åœ–ç‰‡å’Œå°çŸ¥è­˜ï¼‰ -->
      <div class="question-section" id="question-section">
        <div class="question-title">ğŸ¯ è«‹æ¯”æ‰‹ç•«è…³è®“å¹¼å¹¼çµ„çŒœé€™å€‹å‹•ç‰©ï¼š</div>
        <div class="animal-name" id="animal-name">æ°´è±š</div>
        <div class="animal-pronunciation" id="animal-pronunciation">ï¼ˆè±š ã„Šã„¨ã„£ËŠï¼‰</div>
        <div class="animal-english" id="animal-english">Capybara</div>

        <!-- åœ–ç‰‡å’Œå°çŸ¥è­˜ï¼ˆåŒä¸€é é¡¯ç¤ºï¼‰ -->
        <div class="animal-info-inline">
          <div class="animal-image-inline">
            <img src="" alt="å‹•ç‰©åœ–ç‰‡" id="animal-img">
          </div>
          <div class="animal-facts-inline">
            <h4>ğŸŒ¿ å°çŸ¥è­˜</h4>
            <ul id="animal-facts-list"></ul>
          </div>
        </div>
      </div>

      <!-- å‹•ä½œæŒ‰éˆ• -->
      <div class="action-buttons">
        <button class="btn btn-correct" id="correct-btn" onclick="handleCorrect()">âœ… ç­”å°äº†</button>
        <button class="btn btn-foul" id="foul-btn" onclick="handleFoul()">âŒ çŠ¯è¦</button>
        <button class="btn btn-correct" id="correct-last-btn" onclick="handleCorrectLast()" style="display: none;">âœ… ç­”å°äº†ï¼ˆçµç®—ï¼‰</button>
        <button class="btn btn-foul" id="foul-last-btn" onclick="handleFoulLast()" style="display: none;">âŒ çŠ¯è¦ï¼ˆçµç®—ï¼‰</button>
        <button class="btn btn-complete" id="complete-btn" onclick="completeChallenge()" style="display: none;">ğŸ† ç ´é—œ</button>
        <button class="btn btn-restart" onclick="restartChallenge()">ğŸ”„ é‡æ–°æŒ‘æˆ°</button>
        <button class="btn btn-back" onclick="goBack()">ğŸ—ºï¸ è¿”å›åœ°åœ–</button>
      </div>
    </div>
  </div>

  <!-- é¾ç æ­ç¤º Overlay -->
  <div class="success-overlay" id="reveal-overlay">
    <div class="success-content" style="animation: dragonBallReveal 1.2s ease;">
      <div style="font-size: 8rem; margin-bottom: 20px; animation: iconGlow 2s ease-in-out infinite;">ğŸŸ¡</div>
      <h2 style="animation: fadeInUp2 1s ease 0.3s backwards;">çœŸé¾ç ä»»å‹™å®Œæˆï¼</h2>
      <p style="animation: fadeInUp2 1s ease 0.6s backwards;">ä½ ç²å¾—äº†ä¸€é¡†çœŸé¾ç </p>
    </div>
  </div>

  <!-- æˆåŠŸå®Œæˆ Overlay -->
  <div class="success-overlay" id="success-overlay">
    <div class="success-content">
      <div style="font-size: 10rem; margin-bottom: 20px; animation: iconGlow 2s ease-in-out infinite;">ğŸŸ¡</div>
      <h2>æ­å–œï¼æŒ‘æˆ°æˆåŠŸï¼</h2>
      <p>ä½ å€‘æˆåŠŸå®Œæˆå—ç¾æ´²å‹•ç‰©æ¯”æ‰‹ç•«è…³æŒ‘æˆ°ï¼</p>
      <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
        <button class="btn btn-restart" onclick="restartChallenge()">ğŸ”„ é‡æ–°æŒ‘æˆ°</button>
        <button class="btn btn-back" onclick="goBack()">è¿”å›åœ°åœ–</button>
      </div>
    </div>
  </div>

  <!-- æŒ‘æˆ°å¤±æ•— Overlay -->
  <div class="success-overlay" id="fail-overlay">
    <div class="success-content">
      <div style="font-size: 8rem; margin-bottom: 20px;">ğŸ˜¢</div>
      <h2 style="color: #ff6b6b;">æŒ‘æˆ°å¤±æ•—</h2>
      <p>16 é¡ŒçŒœå®Œï¼Œç­”å° <span id="final-correct-count">0</span> / 8 é¡Œ</p>
      <p style="margin-top: 10px; color: #aaa;">å¿…é ˆç­”å° 8 é¡Œæ‰èƒ½éé—œå–”ï¼</p>
      <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; margin-top: 20px;">
        <button class="btn btn-restart" onclick="restartChallenge()">ğŸ”„ é‡æ–°æŒ‘æˆ°</button>
        <button class="btn btn-back" onclick="goBack()">è¿”å›åœ°åœ–</button>
      </div>
    </div>
  </div>

  <script src="../js/shared.js"></script>

  <script>
    const LOCATION_KEY = 'south-america';

    // å—ç¾æ´²å‹•ç‰©é¡Œåº«
    // åœ–ç‰‡è·¯å¾‘ï¼šimages/animals/south-america/01-capybara.jpg (ä¾æ­¤é¡æ¨)
    const animals = [
      {
        id: 1,
        name: 'æ°´è±š',
        pronunciation: 'ï¼ˆè±š ã„Šã„¨ã„£ËŠï¼‰',
        english: 'Capybara',
        image: '../images/animals/south-america/01-capybara.jpg',
        facts: [
          'ä¸–ç•Œä¸Šæœ€å¤§çš„é½§é½’å‹•ç‰©',
          'å–œæ­¡æ³¡æ°´ã€æ¸¸æ³³',
          'å€‹æ€§æº«å’Œï¼Œæ„›å’Œå…¶ä»–å‹•ç‰©ä¸€èµ·ç©'
        ]
      },
      {
        id: 2,
        name: 'å­å½ˆèŸ»',
        pronunciation: '',
        english: 'Bullet Ant',
        image: '../images/animals/south-america/02-bullet-ant.jpg',
        facts: [
          'è¢«å®ƒå’¬åˆ°åƒè¢«å­å½ˆæ“Šä¸­',
          'é«”å‹æœ€å¤§çš„èèŸ»',
          'ä½åœ¨ç†±å¸¶é›¨æ—'
        ]
      },
      {
        id: 3,
        name: 'ç¾Šé§',
        pronunciation: '',
        english: 'Alpaca',
        image: '../images/animals/south-america/03-alpaca.jpg',
        facts: [
          'é•·ç›¸å¯æ„›ï¼Œä¿—ç¨±è‰æ³¥é¦¬',
          'ç¾Šé§æ¯›æ¯”å–€ä»€ç±³çˆ¾ç¾Šæ¯›é‚„è²´',
          'ç”Ÿæ°£æ™‚æœƒåå£æ°´ä½œç‚ºé˜²ç¦¦'
        ]
      },
      {
        id: 4,
        name: 'ç®­æ¯’è›™',
        pronunciation: '',
        english: 'Poison Dart Frog',
        image: '../images/animals/south-america/04-poison-dart-frog.jpg',
        facts: [
          'é®®è±”çš„é¡è‰²ä»£è¡¨ã€Œæˆ‘æœ‰æ¯’ï¼Œåˆ¥åƒæˆ‘ã€',
          'æ¯’æ¶²å¾ˆå¼·ï¼ŒåŸä½æ°‘æœƒæŠŠå®ƒå¡—åœ¨å¹ç®­ä¸Š',
          'å¾åƒä¸‹çš„æœ‰æ¯’çµç‰©ç´¯ç©æ¯’ç´ å­˜åœ¨çš®è†šè£¡'
        ]
      },
      {
        id: 5,
        name: 'å®‰åœ°æ–¯ç¥é·¹',
        pronunciation: '',
        english: 'Andean Condor',
        image: '../images/animals/south-america/05-andean-condor.jpg',
        facts: [
          'ç¿…è†€å¼µé–‹è¶…ç´šå·¨å¤§',
          'ä¾è³´ä¸Šå‡ç†±æ°£æµé£›è¡Œï¼Œä¸ç”¨æ‹æ‰“ç¿…è†€å°±å¯ä»¥é€£çºŒé£›è¡Œ',
          'ä»¥è…è‚‰ç‚ºé£Ÿï¼Œæ˜¯å¤§è‡ªç„¶çš„æ¸…é“å¤«'
        ]
      },
      {
        id: 6,
        name: 'æµ·å…‹åŠ›å£«å…œèŸ²',
        pronunciation: 'ï¼ˆå…œ ã„‰ã„¡ï¼‰',
        english: 'Hercules Beetle',
        image: '../images/animals/south-america/06-hercules-beetle.jpg',
        facts: [
          'ä¸–ç•Œä¸Šé«”å‹æœ€é•·ä¸”åŠ›é‡æœ€å¤§çš„ç”²èŸ²',
          'ä»¥å¸Œè‡˜ç¥è©±è‹±é›„æµ·å…‹åŠ›å£«å‘½å'
        ]
      },
      {
        id: 7,
        name: 'æµ·é¬£èœ¥',
        pronunciation: 'ï¼ˆé¬£ ã„Œã„§ã„Ë‹ï¼‰',
        english: 'Marine Iguana',
        image: '../images/animals/south-america/07-marine-iguana.jpg',
        facts: [
          'ä¸–ç•Œå”¯ä¸€æœƒæ¸¸æ³³çš„èœ¥èœ´',
          'åƒæµ·è—»',
          'å¸¸åœ¨å²©çŸ³ä¸Šæ›¬å¤ªé™½'
        ]
      },
      {
        id: 8,
        name: 'éºé›‰',
        pronunciation: 'ï¼ˆéº ã„•ã„œË‹ï¼‰',
        english: 'Hoatzin',
        image: '../images/animals/south-america/08-hoatzin.jpg',
        facts: [
          'æœ‰å§‹ç¥–é³¥ç‰¹å¾µï¼Œç¿…è†€ä¸Šæœ‰çˆªå­',
          'é¾å…‹é ­çš„ç´…è¤è‰²é•·ç¾½å† ',
          'èº«é«”æ•£ç™¼ç‰›ç³çš„æ°£å‘³ï¼Œåˆç¨±è‡­é³¥'
        ]
      },
      {
        id: 9,
        name: 'ç¾æ´²è±¹',
        pronunciation: '',
        english: 'Jaguar',
        image: '../images/animals/south-america/09-jaguar.jpg',
        facts: [
          'è²“ç§‘æœ€å¼·å’¬åˆåŠ›ï¼Œèƒ½å’¬ç©¿é±·é­šçš„åšçš®æˆ–çƒé¾œçš„ç¡¬æ®¼',
          'å…¨èƒ½é‹å‹•å“¡ï¼Œæ“…é•·çˆ¬æ¨¹èˆ‡å¥”è·‘ï¼Œé‚„å¾ˆæœƒæ¸¸æ³³',
          'ç¨ä¾†ç¨å¾€çš„æ™¨æ˜æ€§/å¤œè¡Œæ€§å‹•ç‰©'
        ]
      },
      {
        id: 10,
        name: 'æ¨¹æ‡¶',
        pronunciation: '',
        english: 'Sloth',
        image: '../images/animals/south-america/10-sloth.jpg',
        facts: [
          'å‹•ä½œè¶…æ…¢',
          'ä¸€æ•´å¤©éƒ½åœ¨æ¨¹ä¸Š',
          'çœ‹èµ·ä¾†å¾ˆæ„›ç¡è¦º'
        ]
      },
      {
        id: 11,
        name: 'å·¨å˜´é³¥',
        pronunciation: '',
        english: 'Toucan',
        image: '../images/animals/south-america/11-toucan.jpg',
        facts: [
          'å˜´å·´åˆå¤§åˆå½©è‰²',
          'å–œæ­¡åƒæ°´æœ',
          'é›¨æ—è£¡çš„æ˜æ˜Ÿå‹•ç‰©'
        ]
      },
      {
        id: 12,
        name: 'ç¶ æ°´èšº',
        pronunciation: 'ï¼ˆèšº ã„–ã„¢ËŠï¼‰',
        english: 'Green Anaconda',
        image: '../images/animals/south-america/12-green-anaconda.jpg',
        facts: [
          'ä¸–ç•Œä¸Šæœ€é‡çš„è›‡',
          'å–œæ­¡ä½åœ¨æ°´é‚Š',
          'åŠ›æ°£éå¸¸å¤§'
        ]
      },
      {
        id: 13,
        name: 'ç²‰ç´…æ²³è±š',
        pronunciation: 'ï¼ˆè±š ã„Šã„¨ã„£ËŠï¼‰',
        english: 'Amazon River Dolphin',
        image: '../images/animals/south-america/13-amazon-river-dolphin.jpg',
        facts: [
          'èº«é«”æ˜¯ç²‰ç´…è‰²çš„',
          'ä½åœ¨äºé¦¬éœæ²³',
          'æœƒç”¨é¡é ­ç™¼å°„è¶…éŸ³æ³¢é€²è¡Œå°èˆªèˆ‡çµé£Ÿ'
        ]
      },
      {
        id: 14,
        name: 'å·´è¥¿å·¨èœ¥',
        pronunciation: '',
        english: 'Tegu Lizard',
        image: '../images/animals/south-america/14-tegu-lizard.jpg',
        facts: [
          'å—ç¾æœ€å¤§çš„èœ¥èœ´ä¹‹ä¸€',
          'å¾ˆè°æ˜',
          'ä»€éº¼éƒ½åƒ'
        ]
      },
      {
        id: 15,
        name: 'å¤§é£ŸèŸ»ç¸',
        pronunciation: '',
        english: 'Giant Anteater',
        image: '../images/animals/south-america/15-giant-anteater.jpg',
        facts: [
          'é•·é•·çš„ç®¡ç‹€é ­éƒ¨',
          'èˆŒé ­æœ‰60å…¬åˆ†é•·',
          'æ¯å¤©åƒæ‰ 3 è¬éš»èèŸ»æˆ–ç™½èŸ»'
        ]
      },
      {
        id: 16,
        name: 'è—é–ƒè¶',
        pronunciation: '',
        english: 'Morpho Butterfly',
        image: '../images/animals/south-america/16-morpho-butterfly.jpg',
        facts: [
          'ç¿…è†€æœƒé–ƒäº®äº®çš„è—å…‰',
          'é£›èµ·ä¾†åƒå°ç²¾éˆ',
          'ä½åœ¨é›¨æ—'
        ]
      }
    ];

    let currentQuestionIndex = 0;
    let selectedQuestions = [];
    let correctCount = 0; // ç­”å°é¡Œæ•¸

    // é–‹å§‹éŠæˆ²
    function startGameFromRules() {
      document.getElementById('rules-section').style.display = 'none';
      document.getElementById('game-area').style.display = 'block';
      initGame();
    }

    const TOTAL_QUESTIONS = 16; // ç¸½é¡Œæ•¸
    const REQUIRED_CORRECT = 8; // éœ€è¦ç­”å°çš„é¡Œæ•¸

    // åˆå§‹åŒ–éŠæˆ²
    function initGame() {
      currentQuestionIndex = 0;
      correctCount = 0;
      // é¸æ“‡å…¨éƒ¨ 16 é¡Œ
      selectedQuestions = animals.slice(0, TOTAL_QUESTIONS);
      updateCorrectDisplay();
      updateProgressDisplay();
      loadQuestion();
    }

    // æ›´æ–°ç­”å°è¨ˆæ•¸é¡¯ç¤º
    function updateCorrectDisplay() {
      document.getElementById('correct-count').textContent = correctCount;
    }

    // æ›´æ–°é€²åº¦é¡¯ç¤º
    function updateProgressDisplay() {
      document.getElementById('current-question').textContent = currentQuestionIndex + 1;
      document.getElementById('total-questions').textContent = TOTAL_QUESTIONS;
    }

    // è¼‰å…¥é¡Œç›®
    function loadQuestion() {
      // æª¢æŸ¥æ˜¯å¦å·²ç¶“ç­”å° 8 é¡Œ -> éé—œ
      if (correctCount >= REQUIRED_CORRECT) {
        completeChallenge();
        return;
      }

      // æª¢æŸ¥æ˜¯å¦æ‰€æœ‰é¡Œç›®éƒ½å·²ç¶“çŒœå®Œ -> å¤±æ•—
      if (currentQuestionIndex >= selectedQuestions.length) {
        showFailMessage();
        return;
      }

      const question = selectedQuestions[currentQuestionIndex];

      // æ›´æ–°é€²åº¦
      updateProgressDisplay();

      // é¡¯ç¤ºé¡Œç›®
      document.getElementById('animal-name').textContent = question.name;
      document.getElementById('animal-pronunciation').textContent = question.pronunciation;
      document.getElementById('animal-english').textContent = question.english;

      // è¨­å®šåœ–ç‰‡
      document.getElementById('animal-img').src = question.image;
      document.getElementById('animal-img').alt = question.name;

      // è¨­å®šå°çŸ¥è­˜
      const factsList = document.getElementById('animal-facts-list');
      factsList.innerHTML = '';
      question.facts.forEach(fact => {
        const li = document.createElement('li');
        li.textContent = fact;
        factsList.appendChild(li);
      });

      // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
      updateButtons();
    }

    // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
    function updateButtons() {
      // ç°¡åŒ–ï¼šåªé¡¯ç¤ºç­”å°å’ŒçŠ¯è¦æŒ‰éˆ•
      document.getElementById('correct-btn').style.display = 'inline-block';
      document.getElementById('foul-btn').style.display = 'inline-block';

      // éš±è—æœ€å¾Œä¸€é¡Œå°ˆç”¨æŒ‰éˆ•ï¼ˆä¸å†éœ€è¦ï¼‰
      document.getElementById('correct-last-btn').style.display = 'none';
      document.getElementById('foul-last-btn').style.display = 'none';

      // éš±è—ç ´é—œæŒ‰éˆ•ï¼ˆæ”¹ç‚ºè‡ªå‹•åˆ¤æ–·ï¼‰
      document.getElementById('complete-btn').style.display = 'none';
    }

    // ç­”å°äº† - å¢åŠ ç­”å°æ•¸ä¸¦è·³åˆ°ä¸‹ä¸€é¡Œ
    function handleCorrect() {
      correctCount++;
      updateCorrectDisplay();
      currentQuestionIndex++;
      loadQuestion();
    }

    // çŠ¯è¦ - ä¸å¢åŠ ç­”å°æ•¸ï¼Œè·³åˆ°ä¸‹ä¸€é¡Œ
    function handleFoul() {
      currentQuestionIndex++;
      loadQuestion();
    }

    // æœ€å¾Œä¸€é¡Œç­”å°
    function handleCorrectLast() {
      correctCount++;
      updateCorrectDisplay();
      checkGameResult();
    }

    // æœ€å¾Œä¸€é¡ŒçŠ¯è¦
    function handleFoulLast() {
      checkGameResult();
    }

    // æª¢æŸ¥éŠæˆ²çµæœ
    function checkGameResult() {
      if (correctCount >= 8) {
        // ç­”å° 8 é¡Œï¼Œéé—œï¼
        completeChallenge();
      } else {
        // æ²’æœ‰ç­”å° 8 é¡Œï¼Œé¡¯ç¤ºå¤±æ•—è¨Šæ¯
        showFailMessage();
      }
    }

    // é¡¯ç¤ºå¤±æ•—è¨Šæ¯
    function showFailMessage() {
      document.getElementById('final-correct-count').textContent = correctCount;
      document.getElementById('fail-overlay').classList.add('show');
    }

    // å®ŒæˆæŒ‘æˆ°ï¼ˆç­”å° 8 é¡Œï¼‰
    function completeChallenge() {
      // æª¢æŸ¥æ˜¯å¦å·²å®Œæˆé
      const completed = getCompletedLocations();
      const isNew = !completed.includes(LOCATION_KEY);

      if (isNew) {
        // é¡¯ç¤ºé¾ç æ­ç¤ºå‹•ç•«
        document.getElementById('reveal-overlay').classList.add('show');

        // 2ç§’å¾Œé¡¯ç¤ºæˆåŠŸé é¢
        setTimeout(() => {
          document.getElementById('reveal-overlay').classList.remove('show');
          markLocationCompleted(LOCATION_KEY);
          document.getElementById('success-overlay').classList.add('show');
        }, 2000);
      } else {
        // å·²å®Œæˆéï¼Œç›´æ¥é¡¯ç¤ºæˆåŠŸé é¢
        document.getElementById('success-overlay').classList.add('show');
      }
    }

    // è¿”å›åœ°åœ–
    function goBack() {
      window.location.href = '../index.html?map=true';
    }

    // é‡æ–°æŒ‘æˆ°ï¼ˆå›åˆ°è¦å‰‡é é¢ä¸¦æ¸…ç©ºç´€éŒ„ï¼‰
    function restartChallenge() {
      // éš±è—æ‰€æœ‰ overlay
      document.getElementById('success-overlay').classList.remove('show');
      document.getElementById('reveal-overlay').classList.remove('show');
      document.getElementById('fail-overlay').classList.remove('show');

      // éš±è—éŠæˆ²å€åŸŸï¼Œé¡¯ç¤ºè¦å‰‡é é¢
      document.getElementById('game-area').style.display = 'none';
      document.getElementById('rules-section').style.display = 'block';

      // é‡ç½®éŠæˆ²ç‹€æ…‹
      currentQuestionIndex = 0;
      correctCount = 0;
      selectedQuestions = [];
    }

    // æª¢æŸ¥æ˜¯å¦å·²å®Œæˆ
    function checkIfCompleted() {
      const completed = getCompletedLocations();
      if (completed.includes(LOCATION_KEY)) {
        // å¯ä»¥é¸æ“‡é¡¯ç¤ºå·²å®Œæˆè¨Šæ¯æˆ–ç›´æ¥è®“ç©å®¶å†ç©
      }
    }

    // åˆå§‹åŒ–æª¢æŸ¥
    checkIfCompleted();
  </script>

</body>
</html>
